"use strict";var DD={generatedId:1,genId:function(){return this.generatedId++},extend:function(){for(var a=arguments,b=a[0],c=1;c<a.length;c++)if("object"==typeof a[c]){var d=a[c];for(var e in d)"object"==typeof d[e]?"object"==typeof b[e]?b[e]=DD.merge(b[e],d[e]):b[e]=DD.merge({},d[e]):b[e]=d[e]}return b},merge:function(a,b){function c(a,b){if(-1!==d.indexOf(b))return b;if(d.push(b),DD.isArray(a)&&DD.isArray(b))b.forEach(function(b,d){DD.isArray(b)?a[d]=c([],b):DD.isObject(b)?a[d]=c({},b):a[d]=b});else for(var e in b)DD.isObject(b[e])?(DD.isObject(a[e])||(a[e]={}),c(a[e],b[e])):DD.isArray(b[e])?(DD.isArray(a[e])||(a[e]=[]),b[e].forEach(function(b,d){var f;f=DD.isObject(b)?c({},b):DD.isArray(b)?c([],b):b,a[e][d]=f})):void 0!==b[e]&&(a[e]=b[e]);return a}var d=[];return c(a,b),a},assign:function(a,b){Object.assign?Object.assign(a,b):DD.getOwnProps(b).forEach(function(c){a[c]=b[c]})},getOwnProps:function(a){return a?Object.getOwnPropertyNames(a):[]},isFunction:function(a){return void 0!==a&&null!==a&&a.constructor===Function},isArray:function(a){return void 0!==a&&null!==a&&a.constructor===Array},isObject:function(a){return null!==a&&void 0!==a&&a.constructor===Object},isInt:function(a){return Number.isInteger(a)},isNumber:function(a){return"number"==typeof a},isBoolean:function(a){return"boolean"==typeof a},isString:function(a){return"string"==typeof a},isEmpty:function(a){if(null===a||void 0===a)return!0;var b=typeof a;if(DD.isObject(a)){var c=Object.keys(a);if(void 0!==c)return 0===c.length}else if("string"===b)return""===a;return!1},get:function(a,b,c){return c=c||document,b===!0?c.querySelectorAll(a):c.querySelector(a)},append:function(a,b){if(DD.isNode(b))a.appendChild(b);else if(DD.isString(b)){var c=DD.newEl("div");c.innerHTML=b,DD.transChildren(c,a)}},isEl:function(a){return void 0!==a&&null!==a&&a.nodeType===Node.ELEMENT_NODE},isNode:function(a){return void 0!==a&&null!==a&&(a.nodeType===Node.TEXT_NODE||a.nodeType===Node.ELEMENT_NODE||a.nodeType===Node.DOCUMENT_FRAGMENT_NODE)},cloneNode:function(a){var b;return b=a.cloneNode(!0),DD.copyProp(b,a),b},copyProp:function(a,b){var c={};if(a&&b){var d=["$model","$module","$events"];DD.getOwnProps(b).forEach(function(a){if("$"===a[0]){for(var e=!1,f=0;f<d.length;f++)if(a===d[f]){e=!0;break}e||(c[a]=b[a])}}),DD.merge(a,c),a.$module=b.$module,a.$events={},b.$model&&(a.$model={},DD.getOwnProps(b.$model).forEach(function(c){a.$model[c]=b.$model[c]})),DD.isEmpty(b.$events)||DD.getOwnProps(b.$events).forEach(function(c){var d=b.$events[c];if(d instanceof DD.Event){d.module;d.view=a,delete d.module;var e=DD.merge({},d);new DD.Event(e)}});for(var e=0;e<a.childNodes.length;e++)DD.copyProp(a.childNodes[e],b.childNodes[e])}},getAttrs:function(a,b){for(var c=[],d=0;d<a.attributes.length;d++){var e=a.attributes[d];b.test(e.name)&&c.push(e)}return c},getAttrsByValue:function(a,b){for(var c=[],d=0;d<a.attributes.length;d++){var e=a.attributes[d];b.test(e.value)&&c.push(e)}return c},copyAttrs:function(a,b){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b.setAttribute(d.name,d.value)}},newEl:function(a,b,c){var d=document.createElement(a);return DD.isObject(b)?DD.attr(d,b):DD.isString(c)&&(d.innerHTML=c),d},newSvgEl:function(a){return document.createElementNS("http://www.w3.org/2000/svg",a)},replaceNode:function(a,b,c){var d=a.parentNode,e=a.nextSibling;null!==d&&(d.removeChild(a),DD.isArray(b)||(b=[b]),b.forEach(function(b){void 0===e||null===e?d.appendChild(b):d.insertBefore(b,e),c!==!1&&(c=!0),c&&a.$isView&&DD.copyProp(b,a)}))},insertAfter:function(a,b,c){var d=this,e=null;void 0===b||null===b?e=c.firstChild:(c=b.parentNode,e=b.nextSibling),DD.isNode(c)&&(null===e?DD.isArray(a)?a.forEach(function(a){d.isEl(a)&&c.appendChild(a)}):c.appendChild(a):DD.isArray(a)?a.forEach(function(a){d.isEl(a)&&c.insertBefore(a,e)}):c.insertBefore(a,e))},empty:function(a){for(var b=a.childNodes,c=b.length-1;c>=0;c--)a.removeChild(b[c])},remove:function(a){null!==a.parentNode&&a.parentNode.removeChild(a)},copyChildren:function(a){for(var b=a.childNodes,c=[],d=b.length-1;d>=0;d--)c.push(b[d]);return c},transChildren:function(a,b){for(var c=document.createDocumentFragment();a.childNodes.length>0;)c.appendChild(a.childNodes[0]);b.appendChild(c)},attr:function(a,b,c){if(void 0===c||null===c){if(DD.isObject(b))DD.getOwnProps(b).forEach(function(c){"value"===c?a[c]=b[c]:a.setAttribute(c,b[c])});else if(DD.isString(b))return"value"===b?b.value:a.getAttribute(b)}else"value"===b?a[b]=c:a.setAttribute(b,c)},css:function(a,b,c){var d;if(window.getComputedStyle&&(d=window.getComputedStyle(a,null)),d)if(void 0===c||null===c){if(!DD.isObject(b))return d[b];DD.getOwnProps(b).forEach(function(c){void 0!==DD.cssconfig&&void 0!==DD.cssconfig[c]?DD.cssconfig[c].forEach(function(d){a.style[d]=b[c]}):a.style[c]=b[c]})}else void 0!==DD.$cssconfig&&void 0!==DD.$cssconfig[b]?DD.$cssconfig[b].forEach(function(b){a.style[b]=c}):a.style[b]=c},width:function(a,b){if(!DD.isNumber(b)){var c;if(window.getComputedStyle&&(c=window.getComputedStyle(a,null)),!c)return null;var d=parseInt(c.width);if(b===!0){var e=parseInt(c.paddingLeft)+parseInt(c.paddingRight);d-=e}return d}a.style.width=b+"px"},height:function(a,b){if(!DD.isNumber(b)){var c;if(window.getComputedStyle&&(c=window.getComputedStyle(a,null)),!c)return null;var d=parseInt(c.height);if(b===!0){var e=parseInt(c.paddingTop)+parseInt(c["paddingBotto,"]);d-=e}return d}a.style.height=b+"px"},addClass:function(a,b){var c=a.className.trim();if(DD.isEmpty(c))a.className=b;else{for(var d=c.split(/\s+/),e=0;e<d.length;e++)if(d[e]===b)return;d.push(b),a.className=d.join(" ")}},removeClass:function(a,b){var c=a.className.trim();if(!DD.isEmpty(c))for(var d=c.split(/\s+/),e=0;e<d.length;e++)if(d[e]===b)return d.splice(e,1),void(a.className=d.join(" "))},formatDate:function(a,b){if(DD.isString(a)){var c=new RegExp(/^\d+$/);if(null!==c.exec(a))try{a=parseInt(a)}catch(d){}}var a=new Date(a),e={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours()%12===0?12:a.getHours()%12,"H+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()},f={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};return/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),DD.getOwnProps(e).forEach(function(a){new RegExp("("+a+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)))}),/(E+)/.test(b)&&(b=b.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+f[a.getDay()+""])),b},toDate:function(a){var b;try{b=new Date(Date.parse(a))}catch(c){}return(isNaN(b)||isNaN(b.getDay()))&&(14===a.length?(a=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2)+" "+a.substr(8,2)+":"+a.substr(10,2)+":"+a.substr(12),b=new Date(Date.parse(a))):8===a.length&&(a=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2),b=new Date(Date.parse(a)))),b},compileStr:function(a){for(var b,c=new RegExp(/\{.+?\}/),d=arguments;null!==(b=c.exec(a));){var e,f=b[0].substr(1,b[0].length-2),g=parseInt(f)+1;e=void 0!==d[g]?d[g]:"",a=a.replace(c,e)}return a},parseJson:function(a){a=a.trim();var b=a.substr(1,a.length-2).split(","),c={},d=new RegExp(/\'/g);new RegExp(/\"/g);return b.forEach(function(a){var b=a.split(":");if('"'!==b[0]&&"'"!==b[0]||'"'!==b[b.length-1]&&"'"!==b[b.length-1]){var e=b[0].replace(d,"\\'"),f=b[1],g=f.length;g>2&&('"'===f[0]&&'"'===f[g-1]||'"'===f[0]&&'"'===f[g-1])&&(f=f.substr(1,g-2)),c[e]=f}}),c},load:function(a,b,c){var d=DD.get("head");switch(null===d&&(d=document.body),a){case"css":var e=DD.get("link[href='"+b+"']");if(null!==e)return;var f=DD.newEl("link");f.type="text/css",f.rel="stylesheet",f.href=b,d.appendChild(f),DD.isFunction(c)&&c();break;case"js":var e=DD.get("script[src='"+b+"']");if(null!==e)return;DD.request({url:b,type:"js",successFunc:function(a){var e=DD.newEl("script");e.innerHTML=a,d.appendChild(e),e.innerHTML="",e.src=b,DD.isFunction(c)&&c()}})}},request:function(a){var b=new XMLHttpRequest,c=a.async===!1?!1:!0;a.type||"text";"function"==typeof a.successFunc&&(b.onload=function(c){switch(b.status){case 200:var d=b.responseText;switch(a.type){case"json":d=JSON.parse(d)}a.successFunc.call(b,d);break;default:DD.isFunction(a.errorFunc)&&a.errorFunc.call(b,b.status)}}),DD.isFunction(a.errorFunc)&&(b.onerror=a.errorFunc),DD.isFunction(a.timeoutFunc)&&(b.ontimeout=a.timeoutFunc);var d=a.reqType||"GET",e=a.url;switch(d){case"GET":var f;if(DD.isObject(a.params)){var g=[];DD.getOwnProps(a.params).forEach(function(b){g.push(b+"="+a.params[b])}),f=g.join("&")}void 0!==f&&(e+=-1!==e.indexOf("?")?"&"+f:"?"+f),b.open(d,e,c,a.user,a.pwd),b.timeout=a.timeout||0,b.send(null);break;case"POST":var h=new FormData;for(var i in a.params)h.append(i,a.params[i]);b.open(d,e,c,a.user,a.pwd),b.timeout=a.timeout||0,b.send(h)}}};DD.config={renderTick:50,appPath:"",deviceType:"ontouchend"in document?1:2},function(){var a=function(a){var b=this;b.events=[],b.view=a.view,b.handler=a.handler,b.eventName=a.eventName,b.delg=a.delg||!1,b.nopopo=a.nopopo||!1,b.once=a.once||!1,b.capture=a.capture||!1,"click"===b.eventName&&1===DD.config.deviceType&&(b.eventName="tap"),b.delg?b.delegate():b.bind()};a.prototype.fire=function(a){function b(){for(var b=0;b<d.events.length;b++){var c=d.events[b];if(c.view.contains(a.target)){if(c.nopopo&&a.stopPropagation(),c.handler.call(d.view.$module.model,a,c.view.$getData().data,c.view),c.once&&d.events.splice(b--,1),c.nopopo)return!1;break}}return!0}function c(){DD.isFunction(d.handler)&&(d.nopopo&&a.stopPropagation(),d.handler.call(d.view.$module.model,a,d.view.$getData().data,d.view),d.once&&delete d.handler)}var d=this;void 0!==d.view&&(d.capture?(c(),b()):b()&&c(),0===d.events.length&&void 0===d.handler&&(DD.Event.TouchEvents[d.eventName]?DD.Event.unregist(d):d.view.removeEventListener(d.eventName,d.handleEvent)))},a.prototype.bind=function(a){var b=this;b.view.$events[b.eventName]||(DD.Event.TouchEvents[b.eventName]?DD.Event.regist(b):(b.handleEvent=function(a){b.fire(a)},b.view.addEventListener(b.eventName,b.handleEvent)),b.view.$events[b.eventName]=b)},a.prototype.unbind=function(a){var b=this;if(DD.Event.TouchEvents[b.eventName])DD.Event.unregist(b);else if(b.parent){var c=b.parent.events.indexOf(b);-1!==c&&b.parent.events.splice(c)}else b.view.removeEventListener(b.eventName,b.handleEvent)},a.prototype.delegate=function(b){var c=this,d=c.view.parentNode;d||(d=document.body);var e;d.$events[c.eventName]?e=d.$events[c.eventName]:(e=new a({eventName:c.eventName,view:d}),e.bind()),-1===e.events.indexOf(c)&&e.events.push(c)},DD.Event=a,DD.Event.TouchEvents={tap:{touchstart:function(a,b){var c=a.touches[0];b.extParams={pos:{sx:c.pageX,sy:c.pageY,t:Date.now()}}},touchmove:function(a,b){var c=b.extParams.pos,d=a.touches[0],e=d.pageX-c.sx,f=d.pageY-c.sy;(Math.abs(e)>5||Math.abs(f)>5)&&(c.move=!0)},touchend:function(a,b){var c=b.extParams.pos,d=Date.now()-c.t;c.move===!0||d>300||b.fire(a)}},swipe:{touchstart:function(a,b){var c=a.touches[0],d=Date.now();b.extParams={swipe:{oldTime:[d,d],speedLoc:[{x:c.pageX,y:c.pageY},{x:c.pageX,y:c.pageY}],oldLoc:{x:c.pageX,y:c.pageY}}}},touchmove:function(a,b){var c=Date.now(),d=a.touches[0],e=b.extParams.swipe;c-e.oldTime>50&&(e.speedLoc[0]={x:e.speedLoc[1].x,y:e.speedLoc[1].y},e.speedLoc[1]={x:d.pageX,y:d.pageY},e.oldTime[0]=e.oldTime[1],e.oldTime[1]=c),e.oldLoc={x:d.pageX,y:d.pageY}},touchend:function(a,b){var c=b.extParams.swipe,d=Date.now(),e=d-c.oldTime[1]<30?0:1,f=c.oldLoc.x-c.speedLoc[e].x,g=c.oldLoc.y-c.speedLoc[e].y,h=Math.sqrt(f*f+g*g),i=d-c.oldTime[e],j=h/i;if(j>.05){var k="";0>f&&Math.abs(g/f)<1&&(a.v0=j,k="swipeleft"),f>0&&Math.abs(g/f)<1&&(a.v0=j,k="swiperight"),g>0&&Math.abs(f/g)<1&&(a.v0=j,k="swipedown"),0>g&&Math.abs(f/g)<1&&(a.v0=j,k="swipeup"),b.eventName===k&&b.fire(a)}}}},DD.Event.TouchEvents.swipeleft=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swiperight=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swipeup=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swipedown=DD.Event.TouchEvents.swipe,DD.Event.regist=function(a){var b=DD.Event.TouchEvents[a.eventName];DD.isEmpty(a.touchListeners)||DD.Event.unregist(a),a.touchListeners={},b&&DD.getOwnProps(b).forEach(function(c){a.touchListeners[c]=function(d){b[c](d,a)},a.view.addEventListener(c,a.touchListeners[c])})},DD.Event.unregist=function(a){var b=DD.Event.TouchEvents[a.eventName];b&&DD.getOwnProps(a.touchListeners).forEach(function(b){a.view.removeEventListener(b,a.touchListeners[b])})}}(),function(){DD.Expression={handle:function(a,b,c){var d=this;if(DD.isArray(b)){var e=!1,f=(b.length,"");return b.forEach(function(b){if("string"===b.type)f+=b.src;else{var g=d.cacExpr(a,b.src,c);!e&&g[0]&&(e=!0),f+=g[1]}}),[e,f]}},initExpr:function(a){for(var b,c=this,d=new RegExp(/\{\{.+?\}\}/g),e=[],f=0;null!==(b=d.exec(a));){if(b.index>f){var g=a.substring(f,b.index);DD.isEmpty(g)||e.push({type:"string",src:g})}e.push({type:"expr",src:c.initOne(b[0].substring(2,b[0].length-2))}),f=b.index+b[0].length}if(f<a.length){var g=a.substr(f);DD.isEmpty(g)||e.push({type:"string",src:g})}if(1===e.length&&1===e[0].src[0].length){var h=e[0].src[0][0].type;if("string"===h||"number"===h||"bool"===h||"blank"===h)return e[0].src[0][0].src}return e},initOne:function(exprStr){function genStack(a){for(var b=[],c=[],d=0,e=0;e<a.length;e++)for(var f=cacSign.length-1;f>=0;f--){var g=cacSign[f].length;if(a.substr(e,g)===cacSign[f]){b.push(a.substr(d,e-d).trim()),c.push(cacSign[f]),e+=g-1,d=e+1;break}}return d<a.length&&b.push(a.substr(d)),[b,c]}function getParams(a){var b=[],c=a.substring(a.indexOf("(")+1,a.lastIndexOf(")"));if(""!==c&&""!==(c=c.trim())){var d=c.split(",");d.forEach(function(a){a=a.trim();for(var c=0;c<strArr.length;c++)if(strPrev+c===a)return void b.push({type:"string",src:strArr[c]});var d;d=isNaN(a)?{type:"field",src:a}:{type:"number",src:a},b.push(d)})}return b}function initFilter(){for(var a=0;a<stacks[1].length;a++)if("|"===stacks[1][a]){var b={type:"filter",exprs:[stacks[0][a],stacks[0][a+1]],signs:[]},c=a,d=stacks[1][a-1],e=0;if(")"===d){e++,b.exprs[0]=stacks[0][a-1],stacks[0].splice(a);for(var f=a-2;f>=0;f--)if(")"===stacks[1][f])e++;else if("("===stacks[1][f]&&0===--e){c=f;break}b.signs.unshift(d);for(var f=a-2;f>=c;f--)b.exprs.unshift(stacks[0][f]),b.signs.unshift(stacks[1][f])}stacks[0].splice(c,a-c+2,b),stacks[1].splice(c,a-c+1),a=c}}for(var cacSign=["(",")","!","|","*","/","+","-",">","<",">=","<=","==","===","&&","||","%"],regFun=new RegExp(/[\w$][\w$\d\.]*\(.*?\)/),regStr=new RegExp(/(\'.+?\')|(\".+?\")/),funPrev="$DDfun_rep_",strPrev="$DDstr_rep_",funArr=[],strArr=[],repIndex=0,r;null!==(r=regStr.exec(exprStr));)exprStr=exprStr.replace(r[0],strPrev+repIndex++),strArr.push(r[0]);for(repIndex=0;null!==(r=regFun.exec(exprStr));)exprStr=exprStr.replace(r[0],funPrev+repIndex++),funArr.push(r[0]);var stacks=genStack(exprStr),stack1=[];return stacks[0].forEach(function(item,ii){for(var i=0;i<funArr.length;i++)if(-1!==item.indexOf(funPrev+i)){var ind1=funArr[i].indexOf("("),fn=funArr[i].substr(0,ind1).trim(),pm=getParams(funArr[i]);return void stack1.push({type:"function",fn:fn,params:pm})}for(var i=0;i<strArr.length;i++)if(-1!==item.indexOf(strPrev+i))return void stack1.push({type:"string",src:item.replace(strPrev+i,strArr[i])});""===item?stack1.push({type:"blank",src:item}):isNaN(item)?"true"===item||"false"===item?stack1.push({type:"bool",src:eval(item)}):stack1.push({type:"field",src:item}):stack1.push({type:"number",src:eval(item)})}),stacks[0]=stack1,initFilter(),stacks},cacExpr:function(module,stacks,model){function invoke(funObj){var foo,isSystem=!1;-1===funObj.fn.indexOf(".")?foo=module.methodFactory.get(funObj.fn):(isSystem=!0,foo=eval(funObj.fn));var pa=[],change=!1;return funObj.params.forEach(function(p){switch(p.type){case"field":var v=getValue(module,p.src,model);v[0]&&(change=!0),v=v[1],pa.push(v);break;case"number":pa.push(eval(p.src));break;default:pa.push(p.src)}}),isSystem?[change,foo.apply(null,pa)]:[change,foo.apply(module.model,pa)]}function filter(filterObj){for(var exprs=filterObj.exprs,signs=filterObj.signs,src,r="",change=!1,i=0;i<exprs.length-1;i++){var r1=cacOne(exprs[i]);r1[0]&&(change=!0),r+=r1[1],i<signs.length&&(r+=signs[i])}if(signs.length>0)try{r=eval(r)}catch(e){}return[change,DD.Filter.handle(module,r,exprs[i].src)]}function cacOne(a){function b(a){if(!hasCac)return a;if(void 0===a||a===!0||a===!1||null===a)return a;if(DD.isString(a)){var b=a.indexOf("'");-1!==b?b>0&&(a='"'+a+'"'):((b=a.indexOf('"'))>0||-1===b)&&(a="'"+a+"'")}return a}switch(a.type){case"field":var c=getValue(module,a.src,model);return[c[0],b(c[1])];case"function":var c=invoke(a);return[c[0],b(c[1])];case"filter":var c=filter(a);return[c[0],b(c[1])];default:return[!1,a.src]}}function getValue(a,b,c){var d=c.data;if(null===d||void 0===d)return[!1,""];if("$index"===b)return[c.oldIndex!==c.index,c.index];if(DD.isFunction(d.$get)){var e=d.$get(b);if(void 0!==e[1])return e}return[!1,""]}for(var expr="",hasCac=!1,i=0;i<stacks[1].length;i++)if(""!==stacks[1][i]){hasCac=!0;break}var isChange=!1;if(stacks[0].forEach(function(a,b){var c=cacOne(a);!isChange&&c[0]&&(isChange=!0);var d=c[1],e="";b<stacks[1].length&&(e=stacks[1][b]),expr+=d+e}),hasCac)try{""!==expr&&(expr=eval(expr))}catch(e){}return[isChange,expr]}}}(),function(){function initmodel(a){var b=this;a=a.trim();var c=b.$getDirective("model");c.value=a}function initrepeat(a){var b,c=this;a=a.trim();var d,e;-1!==(d=a.indexOf("|"))?(b=a.substr(0,d).trim(),e=a.substr(d+1).trim()):b=a;var f=c.$getDirective("repeat");f.value=b,f.filter=e,f.done=!1;var g=document.createTextNode("");DD.replaceNode(c,g),g.$savedDoms.repeat=c,DD.Directive.initViewDirective(g,[{name:"model",value:b}]),c.$removeDirective("repeat")}function initif(a){var b=this,c=b.nextElementSibling||b.nextSibling,d=b.$getDirective("if");d.value=DD.Expression.initExpr("{{"+d.value+"}}");var e=[b];DD.isEl(c)&&c.hasAttribute("x-else")?(d.hasElse=!0,e.push(c)):d.hasElse=!1;var f=document.createTextNode("");DD.replaceNode(b,f),b.$removeDirective("if"),f.$savedDoms["if"]=e}function initelse(a){this.$removeDirective("else"),DD.remove(this)}function initshow(a){var b=this,c=b.$getDirective("show");c.value=DD.Expression.initExpr("{{"+c.value+"}}")}function initclass(value){var view=this,d=view.$getDirective("class"),obj=eval("("+value+")");if(DD.isObject(obj)){var robj={};DD.getOwnProps(obj).forEach(function(a){DD.isString(obj[a])?robj[a]=DD.Expression.initExpr("{{"+obj[a]+"}}",view.$module):robj[a]=obj[a]}),d.value=robj}}function initfield(){var a,b,c=this,d=c.$getDirective("field").value;b=-1!==(a=d.indexOf("|"))?d.substr(0,a):d;var e=c.tagName.toLowerCase(),f="input";"input"!==e||"checkbox"!==c.type&&"radio"!==c.type||(f="change"),"radio"!==c.type&&(c.$attrs.value=DD.Expression.initExpr("{{"+d+"}}",c)),new DD.Event({view:c,eventName:f,handler:function(a,c,d){"checkbox"===d.type&&(DD.attr(d,"yes-value")===d.value?d.value=DD.attr(d,"no-value"):d.value=DD.attr(d,"yes-value")),c[b]=d.value}})}function domodel(a,b){var c=this;b||(c.$model.data=null,c.$model=c.$getData())}function dorepeat(a,b){var c=this;if(DD.isEmpty(a)&&(a=c.$getDirective("repeat")),b||(b=c.$getData()),void 0!==b.data&&DD.isArray(b.data)&&0!==b.data.length){var d=[];d=a.filter?DD.Filter.handle(c.$module,b.data,a.filter):b.data;for(var e=[],f=c.nextElementSibling||c.nextSibling;f&&f.$fromNode===c;)e.push(f),f=f.nextElementSibling||f.nextSibling;var g,g=c;d.forEach(function(a,b){var d;b<e.length?d=e[b]:(d=DD.cloneNode(c.$savedDoms.repeat),d.$fromNode=c,DD.insertAfter(d,g)),d.$model.data=a,d.$forceRender=c.$forceRender,(c.$forceRender||b>=e.length)&&d.$setForceRender(!0),d.$model.index!==b&&(d.$model.oldIndex=d.$model.index,a.$changed=!0),d.$model.index=b,g=d});for(var h=e.length-1;h>=d.length;h--)DD.remove(e[h])}}function doif(a,b){var c=this;DD.isEmpty(a)&&(a=c.$getDirective("if")),b||(b=c.$getData());var d=c.$forceRender||c.$module.forceRender;if(DD.isArray(a.value)){var e=DD.Expression.handle(c.$module,a.value,b);if(!e[0]&&!d)return;var f=e[1]}else f=a.value;f=f&&"false"!==f?!0:!1;var g;if(f){if(a.yes===!0)return;g=c.$savedDoms["if"][0]}else if(a.hasElse){if(a.yes===!1)return;g=c.$savedDoms["if"][1]}if(a.yes=f,c.nextSibling&&c.nextSibling.$fromNode===c&&DD.remove(c.nextSibling),void 0!==g){var h=DD.cloneNode(g);DD.insertAfter(h,c),h.$fromNode=c,h.$setForceRender(!0)}}function doclass(a,b){var c=this;if(c.nodeType===Node.ELEMENT_NODE){DD.isEmpty(a)&&(a=c.$getDirective("class"));var d=a.value;b||(b=c.$getData());var e=c.$forceRender||c.$module.forceRender;DD.getOwnProps(d).forEach(function(a){var f=d[a];if(DD.isArray(d[a])){var g=DD.Expression.handle(c.$module,d[a],b);if(!g[0]&&!e)return;f=g[1]}f=f&&"false"!==f?!0:!1,f?DD.addClass(c,a):DD.removeClass(c,a)})}}function doshow(a,b){function c(){a.yes?(DD.css(e,"display",a.display),e.$setForceRender(!0)):DD.css(e,"display","none")}function d(){var c=!0;if(DD.isArray(a.value)){var d=DD.Expression.handle(e.$module,a.value,b);if(!d[0]&&!e.$forceRender&&!e.$module.forceRender)return!1;c=d[1]}else c=a.value;if(c=c&&"false"!==c?!0:!1){if(a.yes===!0)return!1}else if(a.yes===!1)return!1;return a.yes=c,!0}var e=this;DD.isEmpty(a)&&(a=e.$getDirective("show")),b||(b=e.$getData());var f=d();a.display?f&&c():setTimeout(function(){if(void 0===a.display){var b=DD.css(e,"display");(""===b||"none"===b)&&(b="inline"),a.display=b}f&&c()},0)}function dofield(a,b){var c=this,d=c.type,e=c.tagName.toLowerCase();if("radio"===d||"checkbox"===d||"select"===e){b||(b=c.$getData());var f=c.$forceRender||c.$module.forceRender,g=b.data.$get(a.value);if(g[0]||f){var h=g[1];if("radio"===d){var i=c.value;h==i?DD.attr(c,"checked","checked"):c.removeAttribute("checked")}else if("checkbox"===d){var j=DD.attr(c,"yes-value");h+""==j?(DD.attr(c,"checked","checked"),c.value=j):(c.removeAttribute("checked"),c.value=DD.attr(c,"no-value"))}else"select"===e&&setTimeout(function(){c.value=h},0)}}}DD.Directive={directives:{model:{preOrder:1,once:!1,sys:!0,init:initmodel,handler:domodel},repeat:{preOrder:2,once:!1,sys:!0,init:initrepeat,handler:dorepeat},"class":{preOrder:3,once:!1,sys:!0,init:initclass,handler:doclass},"if":{preOrder:5,once:!1,sys:!0,init:initif,handler:doif},"else":{preOrder:5,once:!1,sys:!0,init:initelse},show:{preOrder:5,sys:!0,init:initshow,handler:doshow},field:{preOrder:5,init:initfield,handler:dofield}},create:function(a){var b=this;(void 0===a.preOrder||a.preOrder<10)&&(a.preOrder=10),a.once=a.once||!1,b.directives[a.name]=a},remove:function(a){var b=this;DD.Directive.directives[name];delete b.directives[a]},get:function(a){return this.directives[a]},sortDirectives:function(a){var b=this,c=a.$directives;c.length>1&&c.sort(function(a,c){var d=a.name,e=c.name,f=b.directives[d],g=b.directives[e];return f.preOrder-g.preOrder})},initViewDirectives:function(a){var b=this,c=DD.getAttrs(a,/^x-/);c.forEach(function(b){a.removeAttribute(b.name)}),c.forEach(function(c){var d=c.name.substr(2),e=c.value;a.$directives.push({name:d,value:e}),void 0!==b.directives[d]&&DD.isFunction(b.directives[d].init)&&b.directives[d].init.call(a,e)}),b.sortDirectives(a)},initViewDirective:function(a,b){var c=this;b.forEach(function(b){a.$hasDirective(b.name)||a.$directives.push(b);b.value;void 0!==c.directives[b.name]&&DD.isFunction(c.directives[b.name].init)&&c.directives[b.name].init.call(a,b.value)}),c.sortDirectives(a)},handle:function(a,b){var c=this,d=[];if(a.$directives.forEach(function(e){var f=e.name,g=c.directives[f];void 0!==g&&DD.isFunction(g.handler)&&(g.handler.call(a,e,b),g.once===!0&&d.push(a.$directives.indexOf(e)))}),d.length>0)for(var e=d.length-1;e>=0;e--)a.$directives.splice(d[e],1)}}}(),function(){DD.Filter={cantEditFilters:["date","currency","number","tolowercase","touppercase","orderBy","filter"],filters:{date:function(a,b){var c=b[0];return c=c.substr(1,c.length-2),DD.formatDate(a,c)},currency:function(a,b){var c;return DD.isArray(b)&&(c=b[0]),"string"==typeof a&&(a=parseFloat(a)),DD.isEmpty(c)&&(c="¥"),c+DD.Filter.filters.number(a,[2])},number:function(a,b){var c=b[0]||0;"string"==typeof a&&(a=parseFloat(a));for(var d=1,e=0;c>e;e++)d*=10;return((a*d+.5|0)/d).toFixed(c)},tolowercase:function(a){return a.toLowerCase()},touppercase:function(a){return a.toUpperCase()},orderBy:function(a,b){var c=b[0],d=b[1]||"asc",e=a.concat([]);return e.sort(function(a,b){return"asc"===d?a[c]>b[c]:a[c]<b[c]}),e},select:function(array,pa){var me=this,handler={odd:function(a){for(var b=[],c=0;c<a.length;c++)c%2===1&&b.push(a[c]);return b},even:function(a){for(var b=[],c=0;c<a.length;c++)c%2===0&&b.push(a[c]);return b},range:function(a,b){var c,d;return c=parseInt(b[0]),d=parseInt(b[1]),a.slice(c,d+1)},index:function(a,b){var c=[],d=a.length;return b.length>0&&b.forEach(function(b){isNaN(b)||(parseInt(b),b>=0&&d>b&&c.push(a[b]))}),c},func:function(a,b){var c=me.methodFactory.get(b[0]);return DD.isFunction(c)?c(a):a},value:function(arr,param){var ret=[];if("{"===param[0]&&"}"===param[param.length-1]&&(param=eval("("+param+")")),DD.isObject(param)){var keys=DD.getOwnProps(param);return arr.filter(function(a){for(var b=0;b<keys.length;b++){var c=a[keys[b]],d=param[keys[b]];if("string"==typeof c&&-1!==c.indexOf(d)||c===d)return!0}return!1})}return arr.filter(function(a){for(var b=DD.getOwnProps(a),c=0;c<b.length;c++){var d=a[b[c]];if(DD.isString(d)&&-1!==d.indexOf(param))return a}})}},type=pa[0].trim();return handler.hasOwnProperty(type)||(type="value"),"range"===type||"index"===type||"func"===type?handler[type].call(me,array,pa.slice(1)):"value"===type?handler[type].call(me,array,pa[0]):handler[type].call(me,array)}},handle:function(a,b,c){var d=this;if(DD.isEmpty(b))return"";if(DD.isEmpty(c))return b;for(var e,f="$DD_rparam_",g=new RegExp(/(\{.+?\})|(".+?")|('.+?')/g),h=[],i=0;null!==(e=g.exec(c));)h.push(e[0]),c=c.replace(e[0],f+i++);var j=c.split("|");return j.forEach(function(c){if(!DD.isEmpty(c.trim())){for(var e=c.split(":"),g=0;g<e.length;g++)e[g]=e[g].trim();var i=e[0];if(h.length>0)for(var j=1;j<e.length;j++)for(var g=0,k=h.length;k>g;g++)e[j]=e[j].trim().replace(f+g,h[g]);DD.isFunction(d.filters[i])&&(b=d.filters[i].call(a,b,e.slice(1)))}}),b},add:function(a,b){var c=this;c.filters[a]=b},remove:function(a){var b=this;delete b.filters[a]}}}(),function(){var a=function(){var a=this;a.methods={}};a.prototype={add:function(a,b){var c=this;c.methods[a]=b},remove:function(a){var b=this;delete b.methods[a]},get:function(a){return this.methods[a]}},DD.MethodFactory=a}(),function(){var a=function(a){var b=this,c=a.data;return b.init=!0,b.module=a.module,DD.isObject(c)?b.createObjectModel(c):DD.isArray(c)&&b.createArrayModel(c),b.data=c,c.$model=b,delete b.init,b.module.model=b,b},b={$fields:void 0,$set:function(a,b){for(var c,d=this,e=a.split("."),f=0;f<e.length-1;f++)c=e[f],d=d[c];c=e[f],void 0===d[c]&&(d.$model.init=!0,Object.defineProperty(d,a,{set:function(b){d.$model.setProp(d,a,b)},get:function(){return d.$model.getProp(d,a)}})),d[c]=b,delete d.$model.init},$get:function(a){for(var b,c=this,d=a.split("."),e=0;e<d.length&&c;e++)if(d[e].lastIndexOf("]")===d[e].length-1){var f=d[e].split("[");c=c[f[0]],f.shift(),f.forEach(function(a){var b=a.substr(0,a.length-1);c=c[parseInt(b)]})}else c.$fields&&(b=c.$fields["$old_"+d[e]],c=c[d[e]]);var g=!1;return void 0!==b&&(g=!0),[g,c]},$isChanged:function(a){function b(a){if(DD.isObject(a))for(var c=DD.getOwnProps(a),d=0;d<c.length;d++){var e=a[c[d]];if(DD.isObject(e)||DD.isArray(e))return e.changed?!0:b(e)}else if(DD.isArray(a))for(var d=0;d<a.length;d++){var e=a[d];if(DD.isObject(e)||DD.isArray(e))return e.changed?!0:b(e)}return!1}return a?this.changed?!0:b(this):this.changed}};a.prototype.setProp=function(a,b,c){var d=this;a.$model=d,void 0===a.$fields&&(a.$fields={});var e=a.$fields[b]!==c;e&&(DD.isObject(c)?(d.init=!0,d.createObjectModel(c),a.$fields[b]=c):DD.isArray(c)?(d.createArrayModel(c),a.$fields[b]=c):(d.init?a.$fields["$old_"+b]=null:a.$fields["$old_"+b]=a.$fields[b],a.$fields[b]=c),d.change(a))},a.prototype.getProp=function(a,b){return a.$fields[b]},a.prototype.change=function(a){a.$changed=!0,DD.Renderer.add(this.module)},a.prototype.clean=function(a){var b=this;a=a||b.data,delete a.$changed,DD.isObject(a)?DD.getOwnProps(a).forEach(function(c){"$"===c[0]||DD.isFunction(a[c])||(DD.isObject(a[c])||DD.isArray(a[c])?b.clean(a[c]):a.$fields&&delete a.$fields["$old_"+c])}):DD.isArray(a)&&a.forEach(function(a){DD.isObject(a)&&b.clean(a)})},a.prototype.setDefault=function(a){var b=this;a=a||b.data,DD.isObject(a)?DD.getOwnProps(a).forEach(function(c){"$"===c[0]||DD.isFunction(a[c])||(DD.isObject(a[c])||DD.isArray(a[c])?b.setDefault(a[c]):a.$fields["$old_"+c]=null)}):DD.isArray(a)&&a.forEach(function(a){DD.isObject(a)&&b.setDefault(a)})},a.prototype.createObjectModel=function(a){var c=this;DD.assign(a,b),a.$model=c,a.$changed=!0,DD.getOwnProps(a).forEach(function(b){if("$"!==b[0]&&!DD.isFunction(a[b])){var d=a[b];Object.defineProperty(a,b,{set:function(d){c.setProp(a,b,d)},get:function(){return c.getProp(a,b)}}),a[b]=d}})},a.prototype.createArrayModel=function(a){var b=this;a.$model=b,a.$changed=!0;for(var c=0;c<a.length;c++){var d=a[c];DD.isObject(d)&&b.createObjectModel(d),DD.isArray(d)&&b.createArrayModel(d)}var e=["push","unshift","splice","pop","shift","reverse","sort"];e.forEach(function(c){a[c]=function(){Array.prototype[c].apply(a,arguments);var d=[];switch(c){case"push":d=arguments;break;case"unshift":d=arguments;break;case"splice":if(arguments.length>2)for(var e=2;e<arguments.length;e++)d.push(arguments[e])}for(var e=0;e<d.length;e++){var f=d[e];DD.isObject(f)&&b.createObjectModel(f),DD.isArray(f)&&b.createArrayModel(f)}b.change(a)}})},DD.Model=a}(),function(){var a=function(a){var b=this;return b.name=a.name||"DDModule_"+DD.genId(),b.methodFactory=new DD.MethodFactory,b.modules=[],b.compiled=!1,b.inited=!1,b.onReceive=a.onReceive,b.onInit=a.onInit,b.fromModules=a.fromModules,b.onRender=a.onRender,b.onFirstRender=a.onFirstRender,b.initConfig=DD.merge({delayInit:!1},a),b.el=b.initConfig.el,DD.isEmpty(a.methods)||DD.getOwnProps(a.methods).forEach(function(c){b.methodFactory.add(c,a.methods[c])}),delete a.methods,b.initConfig.delayInit||b.init(a),a.root===!0&&(DD.App=b),b};a.prototype.init=function(a){var b=this,c=b.initConfig;b.parent=c.parent,b.virtualDom=DD.newEl("div");var d,e;if(b.parent){if(DD.isString(b.parent)){var f=b.parent;b.parent=DD.Module.get(f)}b.parent.modules.push(b),d=b.parent.$rendered?b.parent.view:b.parent.virtualDom}else d=document.body;e=DD.get(c.el,!1,d),e&&e.childNodes&&DD.transChildren(e,b.virtualDom),b.load(function(d,e){if(!DD.isEmpty(e)){var f=DD.newEl("div");f.innerHTML=e,DD.transChildren(f,b.virtualDom)}b.compile(),DD.Renderer.add(b),d=d||{},new DD.Model({data:d,module:b}),DD.isArray(c.modules)&&c.modules.forEach(function(a){b.addModule(a)}),DD.isFunction(c.onInit)&&c.onInit.call(b.model),DD.isFunction(a)&&a(b),delete b.initConfig}),b.inited=!0},a.prototype.load=function(a){function b(){DD.isFunction(a)&&0===i&&a(e,f)}function c(){DD.isArray(h.requires)&&h.requires.length>0?(h.requires.forEach(function(a,b){var c,e="js";switch(DD.isObject(a)?(c=a.path,e=a.type||e):"string"==typeof a&&(c=a),e){case"css":DD.load("css",c);break;default:i++,DD.load("js",c,function(){0===--i&&d()})}}),0===i&&d()):d()}function d(){if(DD.isObject(h.data)?e=h.data:DD.isEmpty(h.dataUrl)||(g.setData({}),i++,DD.request({url:h.dataUrl,type:"json",successFunc:function(a){e=a,0===--i&&b()}})),DD.isEmpty(h.template)){if(!DD.isEmpty(h.templateUrl)){var a=h.templateUrl;DD.config&&!DD.isEmpty(DD.config.appPath)&&(a=DD.config.appPath+"/"+a),i++,DD.request({url:a,successFunc:function(a){f=a,0===--i&&b()}})}}else f=h.template}var e,f,g=this,h=g.initConfig,i=0;c(),0===i&&b()},a.prototype.compile=function(a){var b,c=this;if(c.className&&void 0!==(b=DD.Module.getClass(c.className))&&b.virtualDom)return void(c.virtualDom=b.virtualDom);var d=DD.Compiler.compile(c.virtualDom,c);b&&(b.virtualDom=d),c.compiled=!0},a.prototype.render=function(a,b){
function c(a){return a.view||(a.parent?(a.parent.view||c(a.parent),a.parent.view&&(a.view=DD.get(a.el,!1,a.parent.view))):a.view=DD.get(a.el,!1,document.body)),a.view}var d=this;if(d.compiled&&(!d.parent||d.parent.rendered)&&(c(d),d.view&&(d.view.$isView||(DD.merge(d.view,DD.extendElementConfig),d.view.$isView=!0),!d.needData||d.model))){if(0===d.view.childNodes.length){var e=DD.cloneNode(d.virtualDom);DD.Renderer.renderView(e,d),DD.transChildren(e,d.view),d.view.$containModule=!0,!d.rendered&&DD.isFunction(d.onFirstRender)&&d.onFirstRender.call(d.model),d.rendered=!0,d.renderChildren=!0}else DD.Renderer.renderView(d.view,d);DD.isFunction(d.onRender)&&d.onRender.call(d.model),d.model&&d.model.clean(),d.renderChildren&&d.modules.forEach(function(a){a.renderChildren=!0,a.render()}),delete d.renderChildren,delete d.forceRender,DD.Router&&setTimeout(function(){DD.Router.setRouteFinish(d),DD.Router.linkLoad()},0)}},a.prototype.destroy=function(){delete DD.Module.moduleFactory[this.name],DD.Renderer.remove(this)},a.prototype.addModule=function(a){var b=this;return a.parent=b,DD.Module.create(a)},a.prototype.setData=function(a){var b=this;b.model&&!DD.isEmpty(b.model.data)&&DD.getOwnProps(b.model.data).forEach(function(c){"$"===c[0]&&(a[c]=b.model.data[c])}),new DD.Model({data:a,module:b})},a.prototype.broadcast=function(a){var b=this,c=b.name,d=[];b.parent&&(d.push(b.parent),d=d.concat(b.parent.modules)),d=d.concat(b.modules),d.forEach(function(d){if(d!==b&&DD.isFunction(d.onReceive)){var e=!0;DD.isArray(d.fromModules)&&0!==d.fromModules.length&&-1===d.fromModules.indexOf(c)&&(e=!1),e&&d.onReceive.call(d.model,c,a)}})},a.prototype.send=function(a,b){var c=DD.Module.get(a);DD.isFunction(c.onReceive)&&c.onReceive.call(c.model,this.name,b)},a.prototype.setForceRender=function(a){var b=this;b.forceRender=a,b.modules.forEach(function(b){b.setForceRender(a)})},DD.assign(a,{classFactory:{},moduleFactory:{},define:function(a){var b=this,c=a.className;return b.classFactory[c]=DD.merge({virtualDom:null},a),b.classFactory[c]},getClass:function(a){return this.classFactory[a]},create:function(a){var b,c=this;if(DD.isEmpty(a.className))b=a;else{var d=c.getClass(a.className);void 0!==d&&(b=DD.extend({},d,a))}var e=new DD.Module(b);return c.moduleFactory[e.name]=e,e},get:function(a){return this.moduleFactory[a]}}),DD.assign(DD,{createModule:function(a){return DD.isArray(a)?void a.forEach(function(a){DD.Module.create(a)}):DD.Module.create(a)},defineModule:function(a){return DD.Module.define(a)}}),DD.Module=a}(),DD.extendElementConfig={$module:null,$containModule:null,$isRouterView:!1,$directives:[],$savedDoms:{},$model:{},$attrs:{},$exprs:[],$isView:!0,$events:{},$routeConfig:{},$forceRender:!1,$hasDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a)return!0;return!1},$getDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a)return c[d];return null},$removeDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a){c.splice(d);break}},$getData:function(){var a=this;if(!a.$isView)return null;var b,c,d;if(a.$model&&a.$model.data)b=a.$model.data,c=a.$model.index,d=a.$model.oldIndex;else if(a.$module&&a.$module.model&&a.$module.model.data){for(var e=a;e&&e.$isView&&e!==a.$module.view;e=e.parentNode)if(e.$model&&e.$model.data){c=e.$model.index,b=e.$model.data,d=e.$model.oldIndex;break}if(a.$hasDirective("model")){var f=a.$getDirective("model").value;b?DD.isObject(b)&&(DD.isEmpty(f)||(b=b.$get(f)[1])):b=a.$module.model.data.$get(f)[1]}b||a.$hasDirective("model")||(b=a.$module.model.data)}return{data:b,index:c,oldIndex:d}},$setForceRender:function(a){var b=this;if(b.$forceRender=a,b.childNodes)for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];d.$isView&&d.$setForceRender(a)}}},function(){function a(){DD.Renderer.render(),requestAnimationFrame?requestAnimationFrame(a):setTimeout(a,DD.config.renderTick)}DD.Renderer={waitList:[],add:function(a){var b=this;if(-1===b.waitList.indexOf(a)){if(void 0===a.prio)for(var c=1,d=a.parent;void 0!==d;)c++,d=d.parent;a.prio=c,b.waitList.push(a),b.waitList.sort(function(a,b){return a.prio-b.prio})}},remove:function(a){var b;-1!==(b=me.waitList.indexOf(a))&&me.waitList.splice(b,1)},render:function(){var a=this;if(0!==a.waitList.length)for(var b=0;b<a.waitList.length;b++){var c=a.waitList[b];a.waitList.splice(b--,1),c.render()}},renderView:function(a,b){function c(a,e){if(e||(a.$module=b),!a.$containModule||e){if(a.$isView){!a.$rendered&&DD.isEl(a)&&d(a),a.$hasDirective("model")&&DD.Directive.directives.model.handler.call(a,null);var f=a.$getData();if(f.data&&f.data.$changed||a.$forceRender||b.forceRender){if(DD.isEl(a)){var g=[];DD.getOwnProps(a.$attrs).forEach(function(c){var d=DD.Expression.handle(b,a.$attrs[c],f);if(d[0]||a.$forceRender||b.forceRender){var e=d[1];"x-"===c.substr(0,2)?g.push({name:c.substr(2),value:e}):DD.attr(a,c,e)}}),g.length>0&&DD.Directive.initViewDirective(a,g)}a.$directives.length>0&&DD.Directive.handle(a,f)}var h=a.$getDirective("show");if((!h||h.yes)&&a.childNodes)for(var i=0;i<a.childNodes.length;i++)(a.$isView||f.data.$changed)&&c(a.childNodes[i]);a.$rendered=!0,delete a.$forceRender}else if(b.model&&b.model.data&&a.nodeType===Node.TEXT_NODE&&a.$exprs){var f=a.parentNode.$getData();if(f.data&&f.data.$changed||a.parentNode.$forceRender||b.forceRender){var j=DD.Expression.handle(b,a.$exprs,f);if(!j[0]&&!a.parentNode.$forceRender&&!b.forceRender)return;for(var k=a.nextSibling;k&&k.$genNode;){var l=k.nextSibling;DD.remove(k),k=l}var m=/[(\&lt;.*?\&gt;)(\<.*?\>)]/.test(j[1]);if(m){var n=document.createElement("div");n.innerHTML=j[1],DD.Compiler.compile(n,b);for(var o=document.createDocumentFragment(),i=0;i<n.childNodes.length;){var l=n.childNodes[i];l.$genNode=!0,o.appendChild(n.childNodes[i])}DD.insertAfter(o,a)}else a.textContent=j[1]}}return a}}function d(a){var c=DD.getAttrs(a,/^e-/);c.length>0&&c.forEach(function(c){var d=c.value.split(":"),e=b.methodFactory.get(d[0]);if(e){var f=c.name.substr(2),g={view:a,eventName:f,handler:e};if(d.length>1)for(var h=1;h<d.length;h++)g[d[h]]=!0;new DD.Event(g),a.removeAttribute(c.name)}})}c(a,!0)}},a()}(),function(){DD.Compiler={compile:function(a,b){function c(a){DD.merge(a,DD.extendElementConfig),a.$module=b,DD.getAttrsByValue(a,/\{\{.+?\}\}/).forEach(function(c){b.needData=!0,a.$attrs[c.name]=DD.Expression.initExpr(c.value,a),a.removeAttribute(c.name)}),DD.Directive.initViewDirectives(a),a.$hasDirective("model")&&(b.needData=!0);for(var d=a.childNodes,e=0;e<d.length;e++){var f=d[e];switch(f.nodeType){case Node.TEXT_NODE:""!==f.textContent.trim()&&/\{\{.+\}\}?/.test(f.textContent)&&(b.needData=!0,f.$exprs=DD.Expression.initExpr(f.textContent,b),f.textContent="");break;case Node.COMMENT_NODE:a.removeChild(f),e--;break;default:c(f)}}return a}return c(a)}}}(),DD.Error={handle:function(a){var b=(new RegExp(/\{.+?\}/),DD.ErrorMsgs[a]);if(void 0===b)return"未知错误";for(var c=[b],d=1;d<arguments.length;d++)c.push(arguments[d]);return DD.compileStr.apply(DD,c)}},function(){function a(a){if("activeroute"!==DD.attr(a,"role")){var b,c;for(c=a.parentNode;!b&&c&&(b=DD.get("[role='activeroute']",!1,c),c!==a.$module.view);c=c.parentNode);if(b){b.removeAttribute("role");var d=b.$routeConfig.active;if(d){var e=b.$getData().data;e&&e.$set(d,!1)}}var d=a.$routeConfig.active;if(d){var f=a.$getData();f.data&&f.data.$set(d,!0),DD.attr(a,"role","activeroute")}}}function b(a){return DD.Router.root+a}DD.Router={routes:[],links:[],root:"",currentLinks:[],donop:!1,loading:!1,switching:!1,"switch":{style:"none",time:"0.5s"},currentState:null,history:0,currentPath:void 0,addRoute:function(a){var b=this;a.parent||b.routes.push(a)},removeRoute:function(a){var b,c=this;b=a.parent?a.parent.routes:c.routes,b.splice(b.indexOf(a),1)},setRouteFinish:function(a){var b=this;b.current&&b.current.module===a&&(b.current.loading=!1)},linkLoad:function(){var a=this;if(!a.current||!a.current.loading)if(a.links.length>0){var b=a.links.shift();b.start()}else a.loading=!1},find:function(a){var b=this,c=b.getRouteLink(a);return c.length>0?c[c.length-1]:null},getRouteLink:function(a){function b(a,c){if(!DD.isArray(a)||DD.isEmpty(c))return null;for(var e,f=0;f<a.length;f++){var g=a[f];if(g.path===c)return d.push(g),g;0===c.indexOf(g.path+"/")&&(!e||e.path.length<g.path.length)&&(e=g)}if(e){d.push(e);var h,i=c.substr(e.path.length),j=i.substr(1).split("/");if(DD.isArray(e.routes)&&(h=b(e.routes,i)),null!==h)return h;if("param"===e.type){for(var k=j.length<=e.paramNames.length?j.length:e.paramNames.length,l={},f=0;k>f;f++)l[e.paramNames[f]]=j[f];if(e.newData=l,j.length<=e.paramNames.length)return e;if(j.splice(0,e.paramNames.length),i="/"+j.join("/"),DD.isArray(e.routes))return b(e.routes,i)}}return null}var c=this,d=[];return b(c.routes,a),d},start:function(a,c,d,e){function f(a){a&&(a.view=null,DD.isArray(a.modules)&&a.modules.forEach(function(a){f(a)}))}var g=this;if(a=a.trim(),!DD.isEmpty(a)){if(g.currentPath===a)return!0;void 0===c&&(c=!0),g.links=[];var h=g.getRouteLink(a),i=!1,j=null;if(g.currentLinks.length>0){for(var k=-1,l=h.length>g.currentLinks.length?h.length:g.currentLinks.length,k=l,m=0;l>m;m++)if(g.currentLinks[m]!==h[m]){k=m;break}k===h.length&&g.currentLinks.length>=h.length?k--:k===g.currentLinks.length&&(i=!0),j=h[k],h.splice(0,k);for(var m=g.currentLinks.length-1;m>=k;m--){var n=g.currentLinks[m];if(!n)break;f(n.module),DD.isFunction(n.onLeave)&&n.onLeave(),g.currentLinks.pop()}g.currentLinks=g.currentLinks.concat(h)}else g.currentLinks=[].concat(h);if(g.loading||"none"!==g["switch"].style&&g.switching)if(i)g.links=g.links.concat(h);else if(g.setRouteFinish(g.current.module),j){var o=g.links.indexOf(j);-1!==o&&g.links.splice(o+1,g.links.length),g.links=g.links.concat(h)}else g.links=h;else g.links=h;return g.currentPath=a,g.loading=!0,c&&(g.currentState={path:a,index:g.history++,forward:!0},d?history.replaceState(g.currentState,"",b(a)):history.pushState(g.currentState,"",b(a))),setTimeout(function(){g.linkLoad()},0),!0}}},window.addEventListener("popstate",function(a){var b=DD.Router,c=history.state;if(c){var d=b.currentState&&c.index<b.currentState.index?!1:!0;b.start(c.path,!1)&&(b.currentState=c,b.currentState.forward=d)}});var c=function(a){var b=this;DD.assign(b,a),b.module=a.module,b.routes=[],b.type="string";var c;if(-1!==(c=b.path.indexOf("/:"))){b.type="param";var d=b.path.split("/:");b.path=d[0],b.paramNames=d.slice(1)}b.parent&&b.parent.routes.push(b),DD.Router.addRoute(b),a.routes&&a.routes.forEach(function(a){b.add(a)})};c.prototype.getFullPath=function(){for(var a=this,b="",c=a;c;c=c.parent){var d="";c.paramNames&&c.paramNames.forEach(function(a){void 0!==c.data[a]&&(d+="/"+c.data[a])}),d=c.path+d,b=d+b}return b},c.prototype.start=function(){function b(a){var b;if(c.module.model||new DD.Model({data:{},module:c.module}),c.module.model.data.$set("$route",{path:c.getFullPath(),data:c.data}),c.module.setForceRender(!0),DD.isFunction(c.onEnter)&&c.onEnter(c.module),b=c.parent?c.parent.module.routerView:DD.App.routerView,d["switch"]&&"slide"===d["switch"].style){var e,f,g,h=(b.children,DD.width(b,!0)),i=DD.css(b,"overflowX");if(0===b.children.length)g=b;else{e=DD.newEl("div"),DD.css(b,{overflowX:"hidden"}),DD.css(e,{boxSizing:"border-box",width:2*h+"px",padding:0,margin:0,transition:"transform "+d["switch"].time+" ease-out",transform:"translate3d(0,0,0)",transformStyle:"preserve-3d",overflowX:"hidden"}),e.addEventListener("transitionend",function(){DD.css(b,"overflowX",i),e.children.length>1&&(DD.remove(e),DD.transChildren(g,b),c.module.view=b,d.switching=!1,setTimeout(function(){DD.css(e,"transition","transform "+d["switch"].time+" ease-out")},50))});var f=DD.newEl("div"),g=DD.newEl("div");DD.css(f,{width:h+"px","float":"left",overflowX:i}),DD.css(g,{width:h+"px","float":"left",overflowX:i}),d.switching=!0,DD.merge(g,DD.extendElementConfig),g.$isView=!0,DD.transChildren(b,f),e.appendChild(f),b.appendChild(e);var j=DD.Router.currentState&&!DD.Router.currentState.forward?!1:!0;j?(e.appendChild(g),setTimeout(function(){DD.css(e,"transform","translate3d(-"+h+"px,0,0)")},50)):(DD.css(e,{transition:"",transform:"translate3d(-"+h+"px,0,0)"}),e.insertBefore(g,f),setTimeout(function(){DD.css(e,{transition:"transform "+d["switch"].time+" ease-out",transform:"translate3d(0,0,0)"})},50))}c.module.view=g}else d["switch"]&&"fade"===d["switch"].style||(c.module.view=b,DD.empty(c.module.view));c.module.renderChildren=!0,DD.Renderer.add(c.module)}var c=this,d=DD.Router;if(d.current=c,c.loading=!0,c.data=c.newData,delete c.newData,DD.isString(c.module)){var e=c.module;c.module=DD.Module.get(e)}var f;f=c.parent?c.parent.module.view:DD.App.view;var g=DD.get("[path='"+c.getFullPath()+"']",!1,f);g&&g.$routeConfig&&g.$routeConfig.active&&a(g),c.module.inited?b():c.module.init(function(){b()})},c.prototype.add=function(a){var b=this;a.parent=b;var d=a;return a instanceof DD.Route||(d=new c(a)),d},DD.Route=c,DD.createRoute=function(a){if(DD.isArray(a))a.forEach(function(a){new DD.Route(a)});else if(DD.isObject(a))return new DD.Route(a)},DD.Directive.create({name:"route",preOrder:10,init:function(b){var c=this;b&&(b=b.trim(),DD.isEmpty(b)||b&&"{{"===b.substr(0,2)&&"}}"===b.substr(b.length-2,2)||(DD.attr(c,"path",b),c.$routeConfig={path:b,active:DD.attr(c,"active")},c.removeAttribute("active"),new DD.Event({view:c,eventName:"click",handler:function(b,d,e){e.$routeConfig&&e.$routeConfig.active?a(e):DD.Router.start(c.$routeConfig.path)}})))},handler:function(){var b=this,c=b.$routeConfig.path,d=b.$routeConfig.active;if(!(DD.Router.links.length>0)){var e;if(d){var f=b.$getData().data;f&&f[d]===!0&&(e=!0)}if(e){if(a(b,c),DD.Router.current&&c===DD.Router.current.getFullPath())return;setTimeout(function(){0===c.indexOf(DD.Router.currentPath)?DD.Router.start(b.$routeConfig.path,!0,!0):DD.Router.start(b.$routeConfig.path)},0)}}}}),DD.Directive.create({name:"router",preOrder:10,init:function(a){this.$isRouterView=!0},handler:function(){this.$module.routerView=this}})}(),function(){function a(a,b){for(var c,d=a.parentNode;d;d=d.parentNode)"FORM"===d.tagName&&(c=d);return c?[c.querySelector("[name='"+b+"']"),c]:null}function b(a){var b,c,d=this,e=a;-1!==(b=a.indexOf("|"))&&(e=a.substr(0,b),c=a.substr(b+1)),d.$validity={fn:e,tips:{},method:c};for(var f=d.children,g=0;g<f.length;g++){var h=f[g].getAttribute("rel");d.$validity.tips[h]=f[g]}d.$savedDoms.validity=d,DD.empty(d);var i=document.createTextNode("");DD.replaceNode(d,i)}function c(b){function c(a){for(var b=0;b<a.length;b++)switch(a[b]){case"valueMissing":return"required";case"typeMismatch":return"type";case"tooLong":return"maxLength";case"tooShort":return"minLength";case"rangeUnderflow":return"min";case"rangeOverflow":return"max";case"patternMismatch":return"pattern"}}var d=this;if(DD.isEmpty(b)&&(b=d.$getDirective("validity")),d.$validity&&d.$rendered){var e=a(d,d.$validity.fn);if(e){var f=e[0],g=e[1];DD.$validity.form!==g&&(DD.$validity.valid=!0,DD.$validity.form=g),d.nextSibling.$fromNode===d&&DD.remove(d.nextSibling);var h;if(null!==f){var i=[];if(d.$validity.method){var j=d.$module.methodFactory.get(d.$validity.method);if(DD.isFunction(j)){var k=j.call(d.$module,f.value);k||i.push("custum")}}var l=f.validity;if(!l.valid)for(var m in l)l[m]===!0&&i.push(m);if(i.length>0){DD.$validity.valid=!1;var h=c(i),n=d.$validity.tips,o=d.$savedDoms.validity.cloneNode(!1);if(o.$fromNode=d,DD.isEl(n[h]))o.appendChild(n[h]);else{var p=document.createTextNode(DD.compileStr(DD.FormMsgs[h],DD.attr(f,h)));o.appendChild(p)}DD.insertAfter(o,d)}}}}}DD.Directive.create({name:"validity",preOrder:5,init:b,handler:c}),DD.$validity={valid:!0,form:null,check:function(){return DD.$validity.valid}}}(),function(){DD.Directive.create({name:"plugin",proOrder:10,init:function(a){var b=this,c=DD.Plugin.plugins[a];b.$plugin=new c(b),b.$plugin.init(b)},handler:function(){var a=this,b=a.$getData();(b&&b.data&&b.data.$isChanged(!0)||a.$forceRender||a.$module.forceRender)&&a.$plugin.render(a)}}),DD.Plugin={plugins:{},create:function(a,b){this.plugins[a]=b},remove:function(a){delete this.plugins[a]}}}(),DD.words={system:"系统",module:"模块",moduleClass:"模块类",model:"模型",directive:"指令",expression:"表达式",event:"事件",method:"方法",filter:"过滤器",data:"数据",dataItem:"数据项",route:"路由",routeView:"路由容器",plugin:"插件"},DD.ErrorMsgs={unknown:"未知错误",paramException:"{0} {1}方法参数错误，请参考api",invoke:"{0}方法调用参数{1}必须为{2}",invoke1:"{0}方法调用参数{1}必须为{2}或{3}",invoke2:"{0}方法调用参数{1}或{2}必须为{3}",invoke3:"{0}方法调用参数{1}不能为空",exist:"{0}已存在",exist1:"{0} {1}已存在",notexist:"{0}不存在",notexist1:"{0} {1}不存在",notupd:"{0}不可修改",notremove:"{0}不可删除",notremove1:"{0}{1}不可删除"},DD.FormMsgs={type:"请输入有效的{0}",unknown:"输入错误",required:"不能为空",min:"最小输入值为{0}",max:"最大输入值为{0}"},function(){function getColor(a,b){var c=[[179,33,38],[36,53,66],[80,142,150],[200,109,82],[129,188,158]];if(a.colors&&a.colors.length>b)return a.colors[b];var d,e,f;if(5>b){var g=c[b];d=g[0],e=g[1],f=g[2]}else{var h=b/5|0,i=b%5,g=c[i];d=g[0]+30*h,e=g[1]+30*h,f=g[2]+30*h,d>255&&(d%=255),e>255&&(e%=255),f>255&&(f=e%255)}return"rgb("+d+","+e+","+f+")"}function getConfig(el,obj){var arrs=["margins","colors","fixedCnt","category"],numbers=["margins","width","height","gridLine","fixedCnt"],obj1={};return DD.getOwnProps(obj).forEach(function(pn){var attr=DD.attr(el,pn.toLowerCase());if(attr){if(!attr)return;var pv=attr.trim(),isArr=!1;if(-1!==arrs.indexOf(pn)&&(pv=pv.split(","),isArr=!0),-1!==numbers.indexOf(pn))if(isArr)pv.forEach(function(v,i){try{pv[i]=eval(v)}catch(e){}});else try{pv=eval(pv)}catch(e){}("true"===pv||"false"===pv)&&(pv=eval(pv)),obj1[pn]=pv}}),obj1}function initDefs(a,b){var c=DD.newSvgEl("defs");a.appendChild(c);var d=DD.newSvgEl("marker");DD.attr(d,{id:"$chart_arrow",viewBox:"0 0 10 10",refX:1,refY:5,markerWidth:6,markerHeight:6,orient:"auto"});var e=DD.newSvgEl("path");if(DD.attr(e,{d:"M 0 0 L 10 5 L 0 10 z"}),d.appendChild(e),c.appendChild(d),b){var f=DD.newSvgEl("marker");DD.attr(f,{id:"$chart_circle",refX:3,refY:3,markerWidth:8,markerHeight:8,orient:"auto"});var g=DD.newSvgEl("circle");DD.attr(g,{cx:3,cy:3,r:1.5}),f.appendChild(g),c.appendChild(f);var h=DD.newSvgEl("marker");DD.attr(h,{id:"$chart_tri",viewBox:[0,0,20,20],refX:5,refY:6,markerWidth:9,markerHeight:9,orient:"auto"});var g=DD.newSvgEl("polygon");DD.attr(g,{points:"0,10 5,3 10,10"}),h.appendChild(g),c.appendChild(h);var i=DD.newSvgEl("marker");DD.attr(i,{id:"$chart_rect",refX:2,refY:2,markerWidth:5,markerHeight:5,orient:"auto"});var j=DD.newSvgEl("rect");DD.attr(j,{x:0,y:0,width:3,height:3}),i.appendChild(j),c.appendChild(i);var k=DD.newSvgEl("marker");DD.attr(k,{id:"$chart_cross",viewBox:[0,0,10,10],refX:3,refY:3,markerWidth:6,markerHeight:6,orient:"auto",stroke:"black"});var l=DD.newSvgEl("path");DD.attr(l,{d:"M0 0 L6 6 M0 6 L6 0 Z","stroke-width":2,fill:"none"}),k.appendChild(l),c.appendChild(k);var m=DD.newSvgEl("marker");DD.attr(m,{id:"$chart_star",viewBox:[0,0,35,35],refX:7,refY:7,markerWidth:15,markerHeight:15,orient:"auto",stroke:"black"});var l=DD.newSvgEl("path");DD.attr(l,{d:"m0.75,5.385069l4.20154,0l1.29846,-4.201666l1.29846,4.201666l4.20154,0l-3.399233,2.596676l1.298462,4.201661l-3.399229,-2.596801l-3.399227,2.596801l1.29846,-4.201661l-3.399233,-2.596676l0,0z","stroke-width":1}),m.appendChild(l),c.appendChild(m);var n=[];return n.push({id:"$chart_circle",m:f}),n.push({id:"$chart_tri",m:h}),n.push({id:"$chart_rect",m:i}),n.push({id:"$chart_star",m:m}),n.push({id:"$chart_cross",m:k}),n}}var LEGENDWORDLEN=12,WORDLEN=10,TITLEWORDLEN=18,TITLEHEIGHT=30,SPACELEN=30,DrawArea={left:0,top:0},DEFAULTS={type:"line",dataName:void 0,width:400,height:600,bgColor:"#fff",margins:[40,40,20,20],category:["number","number"],title:void 0,xTitle:void 0,yTitle:void 0,legend:void 0,titleColor:"#000",colors:void 0,fixedCnt:[0,0],marker:!1,showPercent:!1,showText:!1,gridLine:0,gridLineColor:"#ccc"},Chart=function(a){};Chart.prototype.init=function(a){var b=this;b.view=a,b.svg=DD.newSvgEl("svg"),a.appendChild(b.svg),DD.attr(b.svg,{width:"100%",height:"100%"}),DD.css(b.svg,{fontSize:12,background:b.bgColor})},Chart.prototype.render=function(a){var b=this,c=getConfig(a,DEFAULTS);if(!c.width||!c.height){var d=DD.width(a);if(!d)return void setTimeout(function(){b.render(a)},50);c.width=d,c.height=DD.height(a)}DD.extend(b,DEFAULTS,c),b.view=a,b.svg=b.view.children[0],DD.attr(b.svg,{width:b.width,height:b.height}),DD.empty(b.svg);var e=a.$getData();if(b.data=e.data,b.dataName&&(b.data=b.data[b.dataName]),b.data)switch(DrawArea={top:b.margins[0],left:b.margins[3],width:b.width-b.margins[1]-b.margins[3],height:b.height-b.margins[0]-b.margins[2]},b.type){case"line":b.drawLine();break;case"histogram":b.drawHistogram();break;case"pie":b.drawPie()}},Chart.prototype.initData=function(){for(var a,b,c,d,e=this,f=[],g=[],h=0;h<e.data.length;h++){var i=e.data[h];i.datas.sort(function(a,b){return a.x-b.x}),i.title||(i.title="数据"+h);for(var j=0;j<i.datas.length;j++){var k=i.datas[j];"number"===e.category[0]?((!a||k.x<a)&&(a=k.x),(!b||k.x>b)&&(b=k.x)):-1===f.indexOf(k.x)&&f.push(k.x),"number"===e.category[1]?((!c||k.y<c)&&(c=k.y),(!d||k.y>d)&&(d=k.y)):(k.y+="",-1===g.indexOf(k.y)&&g.push(k.y))}}f.length>0&&f.sort(),g.length>0&&g.sort(),e.dataArea={minx:a,maxx:b,miny:c,maxy:d,xValues:f,yValues:g}},Chart.prototype.drawTitle=function(){var a=this;if(a.title){var b=a.title,c=b.length*TITLEWORDLEN,d=(DrawArea.width-c)/2,e=a.margins[0],f=DD.newSvgEl("text");f.innerHTML=b,DD.attr(f,{transform:"translate("+d+","+e+")",fill:a.titleColor,"font-size":18,textLength:c}),a.svg.appendChild(f),DrawArea.top+=TITLEHEIGHT,DrawArea.height-=TITLEHEIGHT}},Chart.prototype.drawLegend=function(){var a=this;if("top"===a.legend||"bottom"===a.legend||"right"===a.legend){for(var b=0,c=0;c<a.data.length;c++)a.data[c].title.length>b&&(b=a.data[c].title.length);var d,e,f,g,h=50+b*WORDLEN,i=a.data.length,j=40,k=DrawArea.width;switch(a.legend){case"top":if(e=DrawArea.top,i*h>k){f=k,d=DrawArea.left;var l=Math.ceil(i*h/k);g=j*l}else f=i*h,g=j,d=(DrawArea.width-f)/2+DrawArea.left;DrawArea.top+=g,DrawArea.height-=g;break;case"right":f=h-25,g=j*i,e=DrawArea.top,d=DrawArea.left+DrawArea.width-f,DrawArea.width-=f;break;case"bottom":if(i*h>k){f=k,d=DrawArea.left;var l=Math.ceil(i*h/k);g=j*l}else f=i*h,g=j,d=(DrawArea.width-f)/2+DrawArea.left;e=DrawArea.top+DrawArea.height-g,DrawArea.height-=g}var m=DD.newSvgEl("g");DD.attr(m,{transform:"translate("+d+","+e+")"});for(var n=0,o=10,c=0;c<a.data.length;c++){var p=getColor(a,c),q=DD.newSvgEl("rect");DD.attr(q,{x:n,y:o,rx:5,ry:5,fill:p,width:30,height:15}),m.appendChild(q);var r=a.data[c].title,s=DD.newSvgEl("text");s.innerHTML=r,DD.attr(s,{x:n+35,y:o+12,fill:p}),DD.css(s,"fontSize",14),m.appendChild(s),f>=n+2*h?n+=h:(n=0,o+=j)}a.svg.appendChild(m)}},Chart.prototype.drawAxes=function(a){function b(){for(var b="",c=0,f=DrawArea.height,g=d.scaleValues.x.values,h=d.scaleValues.x.px,i=0===g[0]?g.length-1:g.length,j=0;i>=j;j++,c+=h){if(c%1&&(c=parseFloat(c.toFixed(d.fixedCnt))),b+=c+","+f+" ",j>0&&(b+=c+","+(f-5)+" "+c+","+f+" ",2===d.gridLine||3===d.gridLine)){var k=DD.newSvgEl("path");DD.attr(k,{d:"M"+c+" "+f+" V 0",stroke:d.gridLineColor,"stroke-width":1}),n.appendChild(k)}if(j>0){var l,m=DD.newSvgEl("text"),o=(g[j-1]+"").length*WORDLEN;l=1===a&&"string"===d.category[0]?(h-o)/2+(j-1)*h:c-o/2,DD.attr(m,{x:l,y:f+20}),DD.css(m,{fill:d.titleColor,strokeWidth:0});var p=0===g[0]?j:j-1;m.innerHTML=g[p],n.appendChild(m)}}if(b+=c-h+SPACELEN+","+f,d.xTitle){var q=DD.newSvgEl("text");q.innerHTML=d.xTitle,n.appendChild(q),DD.attr(q,{x:(DrawArea.width-12*d.xTitle.length)/2,y:f+50}),DD.css(q,{fill:d.titleColor,fontSize:14})}var r=DD.newSvgEl("polyline");DD.attr(r,{points:b,stroke:d.titleColor,"stroke-width":1,"marker-end":"url(#$chart_arrow)"}),n.appendChild(r),c=0,f=DrawArea.height,g=d.scaleValues.y.values,h=d.scaleValues.y.px,b="";for(var i=0===g[0]?g.length-1:g.length,j=0;i>=j;j++,f-=h){if(f%1&&(f=parseFloat(f.toFixed(d.fixedCnt[0]))),b+=c+","+f+" ",j>0&&(b+=c+5+","+f+" "+c+","+f+" ",1===d.gridLine||3===d.gridLine)){var k=DD.newSvgEl("path");DD.attr(k,{d:"M"+c+" "+f+" H "+DrawArea.width,stroke:d.gridLineColor,"stroke-width":1}),n.appendChild(k)}if(j>0){var m=DD.newSvgEl("text");DD.attr(m,{x:c-(g[j-1]+"").length*WORDLEN-10,y:f+4}),DD.css(m,{fill:d.titleColor,strokeWidth:0});var p=0===g[0]?j:j-1;m.innerHTML=g[p],n.appendChild(m)}}if(b+=c+","+(f+h-SPACELEN),d.yTitle){var q=DD.newSvgEl("text");q.innerHTML=d.yTitle;var s=12*d.yTitle.length,t=(DrawArea.height-s)/2-20;DD.attr(q,{transform:"rotate(90) translate("+t+","+(e+15)+")",textLength:s}),DD.css(q,{fill:d.titleColor,fontSize:14}),n.appendChild(q)}r=DD.newSvgEl("polyline"),DD.attr(r,{points:b,stroke:d.titleColor,"stroke-width":1,"marker-end":"url(#$chart_arrow)"}),n.appendChild(r)}function c(a,b){var c=7,d=1,e=1,f=b-a;if(f>100)for(;f>100;)f/=10,d*=10;10>f&&(f*=10,d/=10);var g=1;for(f>=20&&(f/=5,g=5);f>c;f/=2,e*=2);var h,i=g*e*d,j=[],k=Math.ceil((b-a)/i);0===a?(h=1,k--):0>a?(h=Math.floor(a/i),b%i&&(k+=1)):h=Math.floor(a/i);for(var l=h,k=k+h;k>=l;l++)j.push(i*l);return j}var d=this,e="number"===d.category[1]?(d.dataArea.maxy+"").length:d.dataArea.yValues[0].length;e=e*WORDLEN+20;var f=30,g=(d.yTitle?10:0)+e;DrawArea.top+=SPACELEN,DrawArea.height-=SPACELEN+(d.xTitle?25:0)+f,DrawArea.width-=g+SPACELEN+5,DrawArea.left+=g;var h=DrawArea.width,i=DrawArea.height,j="number"===d.category[0]?c(d.dataArea.minx,d.dataArea.maxx):d.dataArea.xValues,k="number"===d.category[1]?c(d.dataArea.miny,d.dataArea.maxy):d.dataArea.yValues,l=j.length,m=k.length;0===j[0]&&l--,0===k[0]&&m--,d.scaleValues={x:{values:j,px:h/l},y:{values:k,px:i/m}};var n=DD.newSvgEl("g");DD.attr(n,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),d.svg.appendChild(n),b()},Chart.prototype.drawLine=function(){function a(a,c){var d=b.markers[a%b.markers.length];if(a>=b.markers.length){var e=d.m.cloneNode(!0),f=d.id+"1";b.svg.querySelector("defs").appendChild(e),DD.attr(e,{id:f});var g={id:f,m:e};b.markers.push(g),d=g}return DD.attr(d.m,{fill:c,stroke:c}),d.id}var b=this;b.initData(),b.title&&b.drawTitle(),b.legend&&b.drawLegend(),b.markers=initDefs(b.svg,!0),b.drawAxes();var c=DD.newSvgEl("g");DD.attr(c,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),b.svg.appendChild(c);var d,e,f=(DrawArea.width,DrawArea.height),g=b.scaleValues.x.px,h=b.scaleValues.y.px,i=0,j=2,k=2,l=b.scaleValues.x.values[0],m=b.scaleValues.y.values[0];if("number"===b.category[0]){var n=b.scaleValues.x.values;i=n[n.length-1]-n[0],d=g*(n.length-1)/i,j=1}var o=0;if("number"===b.category[1]){var n=b.scaleValues.y.values;o=n[n.length-1]-n[0],e=h*(n.length-1)/o,k=1}var p=0;for(q=0;q<b.data.length;q++)b.data[q].datas.length>p&&(p=b.data[q].datas.length);for(var q=0;q<b.data.length;q++){var r=b.data[q].datas,s=DD.newSvgEl("path");c.appendChild(s);var t=getColor(b,q);DD.attr(s,{stroke:t,"stroke-width":2,fill:"none"});for(var u="",v=0;v<r.length;v++){var w=r[v];if(w){var x,y;if(1===j)x=(w.x-l)*d,0!==b.scaleValues.x.values[0]&&(x+=g);else{var z=b.scaleValues.x.values.indexOf(w.x);if(-1===z)continue;x=z*g+g}1===k?(y=f-(w.y-m)*e,0!==m&&(y-=h)):y=b.scaleValues.y.values.indexOf(w.y)*h-h,u+=0===v?"M"+x+" "+y:" L"+x+" "+y}}var A={d:u};if(b.marker){var B="url('#"+a(q,t)+"')";A={d:u,"marker-start":B,"marker-mid":B,"marker-end":B}}DD.attr(s,A)}},Chart.prototype.drawHistogram=function(){var a=this;initDefs(a.svg,!1),a.initData(),a.title&&a.drawTitle(),a.legend&&a.drawLegend(),a.drawAxes(1);var b=DD.newSvgEl("g");DD.attr(b,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),a.svg.appendChild(b);var c=(DrawArea.width,DrawArea.height),d=a.scaleValues.x.px,e=a.scaleValues.y.px,f=40,g=d,h=(g-10)/a.data.length,i=5;h>f&&(h=f,i=(g-h*a.data.length)/2+5);var j,k,l=0,m=0,n=a.scaleValues.x.values[0],o=a.scaleValues.y.values[0],p=a.scaleValues.x.values[a.scaleValues.x.values.length-1],q=a.scaleValues.y.values[a.scaleValues.y.values.length-1];if("number"===a.category[0]){var r=a.scaleValues.x.values;disx=p-n,j=d*(r.length-1)/disx,l=1}var s=0;if("number"===a.category[1]){var r=a.scaleValues.y.values;s=q-o,k=e*(r.length-1)/s,m=1}for(var t=0;t<a.data.length;t++)for(var u=getColor(a.svg,t),v=a.data[t].datas,w=0;w<v.length;w++){var x=v[w],y=w;if(x.x!==a.scaleValues.x.values[w]){y=-1;for(var z=0;z<a.scaleValues.x.values.length;z++)x.x===a.scaleValues.x.values[z]&&(y=z);if(-1===y)continue}if(x){var A,B;if(A=h*t+i+y*g,1===m)B=DrawArea.height-(x.y-o)*k,0!==o&&(B-=e);else{var C=a.scaleValues.y.values.indexOf(x.y);if(-1===C)continue;B=C*e-e}var c=DrawArea.height-B,D=DD.newSvgEl("rect");b.appendChild(D),DD.attr(D,{fill:u,x:A,y:B,width:h,height:c})}}},Chart.prototype.drawPie=function(){function a(a,b,c,d,e,f,g,h,i,j){var k=b+d*Math.cos(e),l=c-d*Math.sin(e),m=b+d*Math.cos(f),n=c-d*Math.sin(f),o="M "+k+" "+l+" A "+d+" "+d+" ,1,0,0, "+m+" "+n+" L "+b+" "+c+" Z",p=DD.newSvgEl("path");DD.attr(p,{d:o,fill:g}),a.appendChild(p);var q=e+(f-e)/2;if(i){var r=180*q/Math.PI,s=DD.newSvgEl("text");s.innerHTML=Math.abs(100*(f-e)/(2*Math.PI)).toFixed(2)+"%";var t=b+d-30-h.length*WORDLEN,u=c+5,v=b,w=c;r>90&&270>r&&(t=b-d+30,u=c+5,r-=180),DD.attr(s,{x:t,y:u,fill:"#fff",transform:"rotate("+-r+","+v+","+w+")"}),a.appendChild(s)}if(j&&h){var x=10,y=20;k=b+d*Math.cos(q),l=c-d*Math.sin(q),m=b+(d+y)*Math.cos(q),n=c-(d+y)*Math.sin(q);var z,A=m,B=h.length*WORDLEN;b>A?(A-=x,z=A-B-5):(A+=x,z=A+5);var p=DD.newSvgEl("path");DD.attr(p,{d:"M"+k+" "+l+" L "+m+" "+n+" H "+A,stroke:g,"stroke-width":1,fill:"none"}),a.appendChild(p);var C=DD.newSvgEl("text");C.innerHTML=h,DD.attr(C,{x:z,y:n+5,fill:g}),a.appendChild(C)}}var b=this;b.title&&b.drawTitle(),b.legend&&b.drawLegend();for(var c=0,d=0;d<b.data.length;d++)b.data[d].title.length>c&&(c=b.data[d].title.length);c*=WORDLEN;var e,f,g,h=DrawArea.width,i=DrawArea.height;if(b.showText){var j=50+2*c,k=60;h-j>=i-k?(e=(i-k)/2,DrawArea.left+=h/2-e,DrawArea.top+=k/2):(e=(h-j)/2,DrawArea.top+=i/2-e,DrawArea.left+=j/2)}else h>i?(e=i/2,DrawArea.left+=h/2-e):(e=h/2,DrawArea.top+=i/2-e);f=e,g=e,DrawArea.height=2*e,DrawArea.width=2*e;var l=DD.newSvgEl("g");DD.attr(l,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),b.svg.appendChild(l);for(var m=0,d=0;d<b.data.length;d++){var n=b.data[d];m+=n.value}for(var o=0,p=0,d=0;d<b.data.length;d++){var n=b.data[d],q=n.value/m;o=p,p+=q*Math.PI*2,a(l,f,g,e,o,p,getColor(b.svg,d),n.title,b.showPercent,b.showText)}},DD.Plugin.create("chart",Chart)}(),function(){var a=function(){};a.prototype.init=function(a){var b=this,c="<div class='nd-plugin-msgbox-mb'></div><div class='nd-plugin-msgbox-box'><div class='nd-plugin-msgbox-title'>{{title}}</div><div class='nd-plugin-msgbox-content'>{{content}}</div><div class='nd-plugin-msgbox-btnct'><a class='nd-plugin-msgbox-btn' x-repeat='buttons'>{{text}}</a></div></div></div>";DD.addClass(a,"nd-plugin-msgbox");var d=DD.attr(a,"showItem")||"show";b.dataName=DD.attr(a,"dataName"),DD.attr(a,"x-show",d),a.$showItem=d,a.removeAttribute("showItem"),a.removeAttribute("dataName"),a.innerHTML=c,DD.Compiler.compile(a,a.$module)},a.prototype.render=function(a){function b(){for(var b=a.querySelectorAll(".nd-plugin-msgbox-btn"),e=100/c.buttons.length|0,f=c.callbacks,g=0;g<b.length;g++){DD.css(b[g],"width",e+"%"),DD.getOwnProps(b[g].$events).forEach(function(a){b[g].$events[a].unbind()}),b[g].$events={};var h;if(f&&f[g]){f[g];h=function(e,g,h){c[a.$showItem]=!1;for(var i=0,j=0;j<b.length;j++)if(b[j]===e.target){i=j;break}var k=d.methodFactory.get(f[i]);DD.isFunction(k)&&k.call(d.model,e,g,h)}}else h=function(b,d,e){c[a.$showItem]=!1};new DD.Event({eventName:"click",view:b[g],handler:h})}}var c=a.$getData().data;if(c){c.buttons&&c.buttons.length>=3&&c.buttons.splice(3,c.buttons.length);var d;d=c.module?c.module:a.$module,d&&setTimeout(b,0)}},DD.Plugin.create("msgbox",a)}();